<!DOCTYPE html>
<html>

<head>
<!-- / display stats / few additions to login page -->
<title>Mnemo</title>
  <meta charset="UTF-8">
  <meta name="description" content="Mnemo">
  <meta name="author" content="Flanja Cosmin-Mihai">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="welcomepage.css">
<style>


  body 
	{
		background-color: #1a1a1a;
		max-height:90vmin;
		max-width:90vmin;
		min-height:90vmin;
		min-width:90vmin;
		color:white;
		font-size:10vmin;
		overflow:hidden;
	}
	
	#buttonsWrapper /* Element which contains the entire memory game   */
	{
		display:none;
	}

	
	#CoolButtons
	{
		min-height:50vmin;
		min-width:50vmin;
		max-height:50vmin;
		max-width:50vmin;
		position:absolute;
		transform:translate(30%,10%);
		left:30%;
		display:grid;
		grid-template: 1fr 1fr / 1fr 1fr;
		grid-column-gap:3vmin;
		grid-row-gap:1vmin;
		padding:5px;
	}
	
	#Menu
	{
		position:absolute;
		transform:translate(10%,50%);
		top:50%;
		min-width:80vw;
		max-width:80vw;
		min-height:30vmin;
		max-height:30vmin;
	}
	
	#CoolResponseButtons
	{
	max-width:22vmin;
	min-width:22vmin;
	min-height:22vmin;
	max-height:22vmin;
	grid-template:1fr 1fr / 1fr 1fr;
	grid-gap:1.5vmin;
	grid-row-gap:1.5vmin;
	padding:2px;
	float:right;
	display:none;
	}
	
	#responseButtonWrapper
	{
	max-width:12vmin;
	min-width:12vmin;
	min-height:12vmin;
	max-height:12vmin;
	float:right;
	display:none;
	}
	
	.gamebutton
	{
	min-width:20vmin;
	max-width:20vmin;
	max-height:20vmin;
	min-height:20vmin;
	padding:0.2vmin;
	border:5px solid black;
	
	}
	
	.responsebutton
	{
	min-width:10vmin;
	max-width:10vmin;
	max-height:10vmin;
	min-height:10vmin;
	color:white;
	border:1px solid black;
	}
	
	#Rosu
	{
	background-color: #660000;
	}
	
	#Albastru
	{
	background-color:#000066;
	}
	
	#Galben
	{
	background-color:#666600;
	}
	
	#Verde
	{
	background-color:#006600;
	}
	
	#r_red
	{
	background-color: #660000;
	}
	
	#r_blue
	{
	background-color:#000066;
	}
	
	#r_yellow
	{
	background-color:#666600;
	}
	
	#r_green
	{
	background-color:#006600;
	}
	
	#startSeries
	{
	width:5vmin;
	padding:0px;
	}
	
	#seriesNumber
	{
	width:3vmin;	
	padding:0px;
	text-align:center;
	}
	#seriesNumberLabel
	{
	width:5vmin;	
	padding:0px;
	}
	
	.seriesNumberLabel
	{
	width:5vmin;	
	padding:0px;
	font-size:1vmin;
	}
	
	#GameStats
	{
	font-size:3vmin;
	}
	
	#finaldiv
	{
	min-width:90vmin;
	min-height:90vmin;
	left:10%;
	position:absolute;
	font-size:8vmin;
	}
	

</style>

</head>

<body>

<div id="welcomeWrapper">

	<label for="usernameInput"  id="usernameInputLabel">Introduceti-va numele!</label><br>
	<input type="text" id="usernameInput" name="username"><br>
	<input type="radio" id="static_Series" name="series_Type" value="Serie statica">
	<label for="static_Series">Serie statica</label>
	<input type="radio" id="dynamic_Series" name="series_Type" value="Serie dinamica">
	<label for="dynamic_Series">Serie dinamica</label>
	<br>
	<button type="button" class="loginbutton" id="log_button" onclick="LogMeIn()">Doresc sa accesez jocul</button><br>
	<div id="leaderboard_link_wrapper">
		<a href="leaderboards.html" id="leaderboard_link">Clasament</a>
	</div>
	<!-- add radio buttons to choose other settings -->

</div> <!--   -->


<div id="buttonsWrapper">

<div id="CoolButtons">

<button type="button" class="gamebutton" id="Rosu" onclick="RedButtonPressed()"></button>

<button type="button" class="gamebutton" id="Galben" onclick="YellowButtonPressed()"></button>

<button type="button" class="gamebutton" id="Verde" onclick="GreenButtonPressed()"></button>

<button type="button" class="gamebutton" id="Albastru" onclick="BlueButtonPressed()"></button>

</div>

<div id="Menu">

<div id="responseButtonWrapper">
	<button type="button" id="response_button" onclick="displayResponseButtons()" style="font-size:3vmin">Doresc sa raspund!</button>
</div>

<div id="CoolResponseButtons">

<button type="button" class="responsebutton" id="r_red" onclick="RedResponsePressed()"></button>

<button type="button" class="responsebutton" id="r_yellow" onclick="YellowResponsePressed()"></button>

<button type="button" class="responsebutton" id="r_green" onclick="GreenResponsePressed()"></button>

<button type="button" class="responsebutton" id="r_blue" onclick="BlueResponsePressed()"></button>

</div>



<input type="button" id="startSeries" value="Start" onclick="startAColorSeries()" style="font-size:5vmin;width: fit-content;" >




<div id="GameStats">

Apasati butonul "Start" pentru a incepe jocul.
<br>
Greseli:0
<br>

</div>
<button type="button"  id="quitbutton" onclick="iquit()" style="font-size:2vmin">Doresc sa renunt.</button>

</div>

</div> <!-- end of buttonsWrapper	-->

<audio id="redAudio">
  <source src="button1short.mp3" type="audio/mpeg">
</audio>

<audio id="yellowAudio">
  <source src="button2short.mp3" type="audio/mpeg">
</audio>

<audio id="blueAudio">
  <source src="button3short.mp3" type="audio/mpeg">
</audio>

<audio id="greenAudio">
  <source src="button4short.mp3" type="audio/mpeg">
</audio>

<audio id="responseAudio">
  <source src="responseButton.mp3" type="audio/mpeg">
</audio>

<script>

let startTime;
let endTime;
let timeSpent;
let series_length;
let s;
let currentSeries;
let userResponse; // this is the variable with the user input
let mistakes;
let correctAnswers=0;
let static_flag; // 1 if the series is static,0 otherwise
function setDefaultParams()
{
	mistakes=0;
	series_length=3;
	if(document.getElementById('static_Series').checked)
	{
	static_flag=1;
	// The user has selected the Static Series option.
		s=
		[ 
			[" "," "," "," "," "," "," "," "," "," "],
			["Verde"," "," "," "," "," "," "," "," "," "],
			["Verde","Albastru"," "," "," "," "," "," "," "," "],
			["Albastru","Galben","Rosu"," "," "," "," "," "," "," "],
			["Verde","Verde","Rosu","Galben"," "," "," "," "," "],
			["Rosu","Rosu","Galben","Albastru","Galben"," "," "," "," "],
			["Verde","Albastru","Albastru","Verde","Rosu","Galben"," "," "," "," "],
			["Verde","Galben","Rosu","Verde","Galben","Galben","Rosu"," "," "," "],
			["Rosu","Verde","Rosu","Verde","Albastru","Galben","Rosu","Verde"," "," "],
			["Rosu","Verde","Verde","Galben","Rosu","Albastru","Rosu","Galben","Albastru"," "],
			["Rosu","Galben","Albastru","Verde","Rosu","Verde","Verde","Galben","Verde","Rosu"]
		];
	}
	if(	document.getElementById('dynamic_Series').checked)
	{
		static_flag=0;
	}
	
}

function startAColorSeries(){
	if(correctAnswers==0)
	{
	startTime=new Date();
	console.log("Start time is:"+startTime);
	}
	if(correctAnswers==0)
	{
	startTime=new Date();
	console.log("Start time is:"+startTime);
	}
	document.getElementById('CoolResponseButtons').style.display="none";
	document.getElementById('responseButtonWrapper').style.display="none";
	var cnt=0;
	currentSeries=[" "," "," "," "];
	//var series_length=document.getElementById('seriesNumber').value;
	var intervalClearTime=series_length*3000+1000;
	var interval;
	if(static_flag==1)
	for (let i = 0; i < series_length; i++) 
	{
		let x;
		x=s[series_length][i];
		currentSeries[i]=x;
	}
	else
	{
	x=generateRandomColorSeries();
	currentSeries=x;
	}
	const timeout=setTimeout(() => {
		document.getElementById(currentSeries[cnt++]).click();
		interval=setInterval(() => {
		document.getElementById(currentSeries[cnt++]).click();
	}, 3000)
	}, 1000)
	
	setTimeout(()=>{
		document.getElementById('responseButtonWrapper').style.display="block";
		clearInterval(interval);
	}, intervalClearTime)
}

function displayResponseButtons()
{	
	document.getElementById('responseButtonWrapper').style.display="none";
	userResponse=[];
	setTimeout(()=>{
		document.getElementById('CoolResponseButtons').style.display="grid";
	}, 300)
}

function refreshButton(){
	location.reload();
}

function RedButtonPressed(){

	document.getElementById("Rosu").style.backgroundColor="#ff0000";
	var redSound = document.getElementById("redAudio"); 
	setTimeout(()=>{
	redSound.play();
	},300)
	setTimeout(() => {
		document.getElementById("Rosu").style.backgroundColor="#660000";
	}, 1500)
}

function YellowButtonPressed(){

	document.getElementById("Galben").style.backgroundColor="#ffff00";
	var yellowSound = document.getElementById("yellowAudio");
	setTimeout(()=>{
	yellowSound.play();
	},300)	
	setTimeout(() => {
		document.getElementById("Galben").style.backgroundColor="#666600";
	}, 1500)
}

function GreenButtonPressed(){
	document.getElementById("Verde").style.backgroundColor="#00ff00";
	var greenSound = document.getElementById("greenAudio"); 
	setTimeout(()=>{
	greenSound.play();
	},300)	
	setTimeout(() => {
		document.getElementById("Verde").style.backgroundColor="#006600";
	}, 1500)
}

function BlueButtonPressed(){
	document.getElementById('Albastru').style.backgroundColor="#0000ff";
	var blueSound = document.getElementById("blueAudio"); 
	setTimeout(()=>{
	blueSound.play();
	},300)	
	setTimeout(() => {
		document.getElementById("Albastru").style.backgroundColor="#000066";
	}, 1500)
}
function RedResponsePressed()
{
	userResponse.push("Rosu");
	console.log("Rosu");
	document.getElementById("r_red").style.backgroundColor="#ff0000";
	var sound = document.getElementById("responseAudio"); 
	sound.pause();	
	sound.currentTime = 0;
	sound.play();
	setTimeout(() => {
		document.getElementById("r_red").style.backgroundColor="#660000";
	}, 300)
	if(userResponse.length==series_length)
		checkUserAnswer();
}

function YellowResponsePressed()
{
	userResponse.push("Galben");
	console.log("Galben");
	document.getElementById("r_yellow").style.backgroundColor="#ffff00";
	var sound = document.getElementById("responseAudio"); 
	sound.pause();	
	sound.currentTime = 0;
	sound.play();
	setTimeout(() => {
		document.getElementById("r_yellow").style.backgroundColor="#666600";
	}, 300)
	if(userResponse.length==series_length)
		checkUserAnswer();
	/*
	for(let i=series_length-1;i<series_length;i++)
	userResponse[i]=" ";
	for(let i=0;i<series_length;i++)
		{
			console.log(userResponse[i]);
			if(userResponse[i]!=currentSeries[i])
			equalArrays=0;
		}
		if(equalArrays==1)
		alert("Raspuns corect");
		else
		alert("Raspuns gresit");
	*/
	
}

function GreenResponsePressed()
{
	userResponse.push("Verde");
	console.log("Verde");
	document.getElementById("r_green").style.backgroundColor="#00ff00";
	var sound = document.getElementById("responseAudio");
	sound.pause();	
	sound.currentTime = 0;
	sound.play();
	setTimeout(() => {
		document.getElementById("r_green").style.backgroundColor="#006600";
	}, 300)
	if(userResponse.length==series_length)
		checkUserAnswer();
}

function BlueResponsePressed()
{
	userResponse.push("Albastru");
	console.log("Albastru");
	document.getElementById('r_blue').style.backgroundColor="#0000ff";
	var sound = document.getElementById("responseAudio"); 
	sound.pause();	
	sound.currentTime = 0;
	sound.play();
	setTimeout(() => {
		document.getElementById("r_blue").style.backgroundColor="#000066";
	}, 300)
	if(userResponse.length==series_length)
		checkUserAnswer();
}

function checkUserAnswer()
{
	let ok=1;
	let remainingSeriesNumber=0;
	document.getElementById('CoolResponseButtons').style.display="none";
	for(let i=0;i<series_length;i++)
		if(userResponse[i]!=currentSeries[i])
			ok=0;
	if(ok==0)
		{
			alert("Raspunsul dat a fost gresit");
			mistakes++;
			remainingSeriesNumber=10-series_length+1;
			document.getElementById('GameStats').innerHTML="Mai aveti de raspuns la "+remainingSeriesNumber+" serii.";
			document.getElementById('GameStats').innerHTML+="<br>";
			document.getElementById('GameStats').innerHTML+="Greseli:"+mistakes;
		}
	else
		{
			alert("Raspunsul dat a fost corect");
			series_length++;
			correctAnswers++;
			remainingSeriesNumber=10-series_length+1;
			document.getElementById('GameStats').innerHTML="Mai aveti de raspuns la "+remainingSeriesNumber+" serii.";
			document.getElementById('GameStats').innerHTML+="<br>";
			document.getElementById('GameStats').innerHTML+="Greseli:"+mistakes;
			if(series_length==11)
			{
				displayEndScreen();
			}
		}
}
function displayEndScreen()
{
document.getElementById('CoolResponseButtons').style.display="none";
				document.getElementById('responseButtonWrapper').style.display="none";
				document.getElementById('CoolButtons').style.display="none";
				document.body.innerHTML=" ";
				let finaldiv=document.createElement("div");
				finaldiv.setAttribute("id","finaldiv");
				let finalcontent=document.createTextNode("Ati raspuns corect la toate seriile.");
				let congrats=document.createTextNode("Felicitari!");
				let br=document.createElement("br");
				let br2=document.createElement("br");
				let mistakescount=document.createTextNode("Greseli:"+mistakes);
				finaldiv.appendChild(congrats);
				finaldiv.appendChild(br2);
				finaldiv.appendChild(finalcontent);
				finaldiv.appendChild(br);
				finaldiv.appendChild(mistakescount);
				let pyro=document.createElement("div");
				pyro.setAttribute("class","pyro");
				let before=document.createElement("div");
				before.setAttribute("class","before");
				let after=document.createElement("div");
				after.setAttribute("class","after");
				pyro.appendChild(before);
				pyro.appendChild(after);
				
				endTime=new Date();
				console.log("End time is:"+endTime);
				timeSpent = new Date(endTime).getTime()-new Date(startTime).getTime();
				let time=document.createElement("div");
				var minutes=Math.floor(timeSpent/60000);
       				 var seconds=(timeSpent/1000)%60;
				let time_spent=document.createTextNode("Timp:"+minutes+" minute si "+seconds.toFixed(2)+" secunde.");
				time.appendChild(time_spent);
				finaldiv.appendChild(time);
				
				document.body.appendChild(finaldiv);
				document.body.appendChild(pyro);
				let finalaudio=document.createElement("audio");
				finalaudio.id = 'finalaudio';
				finalaudio.src = 'victorytrumpet.mp3';
				finalaudio.type= 'audio/mpeg';
				document.body.appendChild(finalaudio);
				finalaudio.play();
				
				
}

function LogMeIn()
{
	document.getElementById('buttonsWrapper').style.display="block";
	document.getElementById('welcomeWrapper').style.display="none";
	setDefaultParams();
}

function iquit()
{	
	
	document.getElementById('CoolResponseButtons').style.display="none";
	document.getElementById('responseButtonWrapper').style.display="none";
	document.getElementById('CoolButtons').style.display="none";
	document.body.innerHTML=" ";
	let finaldiv=document.createElement("div");
	finaldiv.setAttribute("id","finaldiv");
	let finalcontent=document.createTextNode("Ati raspuns corect la "+correctAnswers+" serii.");
	let br=document.createElement("br");
	let mistakescount=document.createTextNode("Greseli:"+mistakes);
	finaldiv.appendChild(finalcontent);
	finaldiv.appendChild(br);
	finaldiv.appendChild(mistakescount);
	document.body.appendChild(finaldiv);
	endTime=new Date().toLocaleTimeString();
	timeSpent=endTime-startTime;
	
}



function generateRandomColorSeries()
{
	let rand_series=[];
	for(let ii=0;ii<series_length;ii++)
	{
		rand_series[ii]=random_ColorPicker();
		console.log(ii+ "si valoarea "+rand_series[ii]);
	}
	return rand_series;
}

function random_ColorPicker()
{
	let rcolor=Math.floor(Math.random() * 4);
	if(rcolor==0)
		return "Rosu";
	if(rcolor==1)
		return "Albastru";
	if(rcolor==2)
		return "Verde";
	if(rcolor==3)
		return "Galben";
}


</script>




</body>

</html>
